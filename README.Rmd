---
always_allow_html: yes
output:
  github_document:
    toc: true
---

Herein lies a `README` to help you navigate the galleries.

```{r include = FALSE}
library(fs)
library(kableExtra)
library(tidyverse)
knitr::opts_chunk$set(echo = FALSE, warning = FALSE, message = FALSE, comment = NA)
root <- "https://apreshill.github.io/rmd-render-factory/"
```

```{r}
gallery_factory <- function(dir = "gallery", 
                            type = c("themes", "highlighters", "outputs", "viridis-options")){
  type <- match.arg(type)
  html_dir <- dir_ls(glue::glue("{dir}/{type}"), recursive = TRUE, glob = "*.html")
  html_items <- html_dir %>% 
    enframe(name = "path", value = "junk") %>% 
    select(-junk) %>% 
    mutate(path = glue::glue("{root}{path}")) %>% 
    mutate(link_read = path %>% fs::path_file(.) %>% path_ext_remove(.) %>% as.character())
  html_table <- html_items %>% 
    mutate(link = cell_spec(link_read, 
                           "html", 
                          link = path)) %>% 
    select(link) %>% 
    set_names(nm = glue::glue("Gallery of {type}")) %>% 
    kable("html", escape = FALSE) %>%
    kable_styling(bootstrap_options = c("hover", "condensed"))
  return(html_table)
}

gallery_render <- function(type = c("single", "themes", "highlighters", "outputs", "palettes")){
  type <- match.arg(type)
  script <- readLines(glue::glue("render_{type}.R"))
  cat(script, sep = "\n")
}
```

# Themes

R Markdown comes with some several built-in `theme`s. Themes are drawn from the Bootswatch theme library. Valid themes include `r knitr::combine_words(rmarkdown:::themes(), before='\x60')`. Pass `null` for no theme. To use a theme for a single .html file output from a .Rmd file, you edit your YAML:

```yaml
title: "README.Rmd"
output_format: 
  html_document:
    theme: flatly
```

```{r}
gallery_factory(type = "themes")
```

And here is the script to generate the themes:

```{r}
gallery_render("themes")
```

# Highlighters

R Markdown also comes with several built-in syntax highlighting styles. Supported styles include `r knitr::combine_words(rmarkdown:::html_highlighters(), before='\x60')`. Pass `null` to prevent syntax highlighting. To use a highlighter for a single .html file output from a .Rmd file, you edit your YAML:

```yaml
title: "README.Rmd"
output_format: 
  html_document:
    highlighter: tango
```


```{r}
gallery_factory(type = "highlighters")
```

And here is the script to generate the highlighters:

```{r}
gallery_render("highlighters")
```

# Output formats 


```{r}
gallery_factory(type = "outputs")
```

And here is the script to generate the outputs:

```{r}
gallery_render("outputs")
```

# Viridis options

```{r}
gallery_factory(type = "viridis-options")
```

And here is the script to generate the viridis palettes:

```{r}
gallery_render("palettes")
```

```{r eval = FALSE, include = FALSE}
# works just for one
# saving here for posterity
themes <- dir_ls("gallery/themes", recursive = TRUE, glob = "*.html") %>% 
  enframe(name = "path", value = "junk") %>% 
  select(-junk) %>% 
  mutate(path = glue::glue("{root}{path}")) %>% 
  mutate(link_read = path %>% fs::path_file(.) %>% path_ext_remove(.) %>% as.character())

themes %>% 
  mutate(link = cell_spec(link_read, 
                           "html", 
                          link = path)
         ) %>% 
  select("Theme Gallery" = link) %>% 
  kable("html", escape = FALSE) %>%
  kable_styling(bootstrap_options = c("hover", "condensed")) 

# testing out screenshots for thumbnails
webshot("https://apreshill.github.io/rmd-render-factory/gallery/themes/darkly.html", "themes-darkly.png", cliprect = "viewport")
```
